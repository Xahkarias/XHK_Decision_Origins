decision_origins_prosperous_unification = {
	length = 1
	icon = "GFX_edict_type_policy"
	
	resources = {
		category = edicts
	}

	potential = {
		is_ai = no
		days_passed < 30
		NOR = {
			has_country_flag = decision_origins_prosperous_unification
			has_origin = origin_default
		}
	}

	effect = {
		hidden_effect = {
			set_country_flag = decision_origins_prosperous_unification
			if = {
				limit = {
					is_gestalt = no
				}
				capital_scope = {
					add_modifier = { modifier = prosp_uni_mod days = 7200 }
				}
			}
			else = {
				capital_scope = {
					add_modifier = { modifier = prosp_uni_mod_gestalt days = 7200 }
				}
			}
			# this is for compatibility with any form of district set, simply gives 2 extra district slots
			capital_scope = {
				add_deposit = xhk_d_prosp_unif
			}
		}
		capital_scope = {
			
			create_pop_group = {
				size = 400
				species = owner_main_species
			}		
		}
		add_research_option = tech_planetary_unification
		custom_tooltip = edict_decision_origins_prosperous_unification_tt
		show_only_custom_tooltip = no
	}
}

decision_origins_tree_of_life = {
	length = 1
	icon = "GFX_edict_type_policy"
	
	resources = {
		category = edicts
	}

	potential = {
		host_has_dlc = "Utopia"
		is_ai = no
		days_passed < 30
		NOR = {
			has_country_flag = decision_origins_tree_of_life
			has_origin = origin_tree_of_life
		}
	}

	effect = {
		hidden_effect = {
			set_country_flag = decision_origins_tree_of_life
		}
		add_modifier = { modifier = xhk_decori_tree_life_modifier }
		## add deposit and pops
		capital_scope = {
			add_deposit = d_tree_of_life_home
		}
	}
}

decision_origins_life_seeded = {
	length = 1
	icon = "GFX_edict_type_policy"
	
	resources = {
		category = edicts
	}

	potential = {
		host_has_dlc = "Apocalypse"
		is_ai = no
		days_passed < 30
		capital_scope = { is_artificial = no }
		NOR = {
			has_country_flag = decision_origins_life_seeded
			has_origin = origin_life_seeded
		}
	}

	allow = {
		days_passed > 0
	}

	effect = {
		hidden_effect = {
			set_country_flag = decision_origins_life_seeded
			## modify if not mechanical
			every_owned_species = {
				limit = {
					is_robotic = no
				}
				set_habitability_trait = { trait = trait_pc_gaia_preference }
			}
		}
		## add deposit
		capital_scope = {
			change_pc = pc_gaia
			set_planet_size = 30
			add_deposit = d_tempestous_mountain
			add_deposit = d_submerged_ore_veins
			add_deposit = d_teeming_reef
			add_deposit = d_dust_caverns
			add_deposit = d_bubbling_swamp
			add_deposit = d_crystalline_caverns
		}
		custom_tooltip = "edict_decision_origins_life_seeded_tt"
		show_only_custom_tooltip = no
	}
}

decision_origins_resource_consolidation = {
	length = 1
	icon = "GFX_edict_type_policy"
	
	resources = {
		category = edicts
	}

	potential = {
		host_has_dlc = "Synthetic Dawn Story Pack"
		is_ai = no
		days_passed < 30
		is_machine_empire = yes
		capital_scope = { is_artificial = no }
		NOR = {
			has_country_flag = decision_origins_resource_consolidation
			has_origin = origin_machine
		}
	}

	effect = {
		hidden_effect = {
			set_country_flag = decision_origins_resource_consolidation
		}
		capital_scope = {
			change_pc = pc_machine
			add_deposit = d_machine_minerals

			hidden_effect = {
				if = {
					limit = {
						owner = { has_valid_civic = civic_machine_assimilator }
					}
					add_deposit = d_organic_slurry
					every_owned_species = {
						limit = {
							is_robotic = no
						}
						set_habitability_trait = { trait = trait_pc_machine_preference }
					}
				}
				
				add_zone = {
					district = district_nexus_1
					zone = zone_energy_nexus
					replace = yes
				}

				add_zone = {
					district = district_nexus_2
					zone = zone_minerals_nexus
					replace = yes
				}
			}
			
		}
		custom_tooltip = "edict_decision_origins_resource_consolidation_tt"
		show_only_custom_tooltip = no
	}
}

decision_origins_post_apocalyptic = {
	length = 1
	icon = "GFX_edict_type_policy"
	
	resources = {
		category = edicts
	}

	potential = {
		host_has_dlc = "Apocalypse"
		is_ai = no
		capital_scope = { is_artificial = no }
		days_passed < 30
		NOT = {
			has_country_flag = decision_origins_post_apocalyptic
		}
	}

	allow = {
		days_passed > 0
	}

	effect = {
		hidden_effect = {
			set_country_flag = decision_origins_post_apocalyptic

			every_owned_species = {
				limit = {
					is_robotic = no
				}
				change_species_characteristics = {
					add_trait = trait_survivor
				}
			}

			every_owned_species = {
				limit = {
					is_robotic = yes
				}
				change_species_characteristics = {
					add_trait = trait_robot_survivor
				}
			}
		}

		capital_scope = {
			change_pc = pc_nuked
		}
		
		
		custom_tooltip = "edict_decision_origins_post_apocalyptic_tt"
		show_only_custom_tooltip = no
	}
}

decision_origins_ocean_paradise = {
	length = 1
	icon = "GFX_edict_type_policy"
	
	resources = {
		category = edicts
	}

	potential = {
		host_has_dlc = "Aquatics Species Pack"
		is_ai = no
		capital_scope = { is_artificial = no }
		days_passed < 30
		NOT = {
			has_country_flag = decision_origins_ocean_paradise
		}
	}

	allow = {
		days_passed > 0
	}

	effect = {
		hidden_effect = {
			set_country_flag = decision_origins_ocean_paradise

			every_owned_species = {
				limit = {
					is_robotic = no
				}
				change_species_characteristics = {
					add_trait = trait_aquatic
				}
			}

			every_owned_species = {
				limit = {
					is_robotic = yes
				}
				change_species_characteristics = {
					add_trait = trait_robot_aquatic
				}
			}
		}
		
		capital_scope = {
			set_planet_size = 30
			change_pc = pc_ocean
			add_deposit = d_teeming_reef
			add_deposit = d_submerged_ore_veins
			add_deposit = d_underwater_vent
			add_deposit = d_crystal_reef
		}

		custom_tooltip = "edict_decision_origins_ocean_paradise_tt"
		show_only_custom_tooltip = no
	}
}

decision_origins_subterranean = {
	length = 1
	icon = "GFX_edict_type_policy"
	
	resources = {
		category = edicts
	}

	potential = {
		host_has_dlc = "Overlord"
		is_ai = no
		days_passed < 30
		NOT = {
			has_country_flag = decision_origins_subterranean
		}
	}

	allow = {
		days_passed > 0
	}

	effect = {
		hidden_effect = {
			set_country_flag = decision_origins_subterranean
			every_owned_species = {
				limit = {
					is_robotic = yes
				}
				change_species_characteristics = {
					add_trait = trait_robot_cave_dweller
				}
			}
			every_owned_species = {
				limit = {
					is_robotic = no
				}
				change_species_characteristics = {
					add_trait = trait_cave_dweller
				}
			}
		}
		add_modifier = { modifier = xhk_decori_subterranean_modifier }
		custom_tooltip = "edict_decision_origins_subterranean_tt"
		show_only_custom_tooltip = no
	}
}

decision_origins_overtuned = {
	length = 1
	icon = "GFX_edict_type_policy"
	
	resources = {
		category = edicts
	}

	potential = {
		host_has_dlc = "Toxoids Species Pack"
		is_ai = no
		days_passed < 30
		NOT = {
			has_country_flag = decision_origins_overtuned
		}
	}

	effect = {
		give_technology = { message = no tech = tech_gene_tailoring }
		hidden_effect = {
			set_country_flag = decision_origins_overtuned
		}
		custom_tooltip = "edict_decision_origins_overtuned_tt"
		show_only_custom_tooltip = no
	}
}

decision_origins_toxic_knights = {
	length = 1
	icon = "GFX_edict_type_policy"
	
	resources = {
		category = edicts
	}

	potential = {
		host_has_dlc = "Toxoids Species Pack"
		is_ai = no
		is_gestalt = no
		capital_scope = {
			NOT = { is_planet_class = pc_habitat }
		}
		days_passed < 30
		NOT = {
			has_country_flag = decision_toxic_knights
		}
	}

	effect = {
		# capital stuff
		hidden_effect = {
			set_country_flag = decision_toxic_knights
			capital_scope = {			
				set_planet_flag = toxic_knights_habitat

				if = {
					## change the first zone, should be archives to the special zone
					limit = {
						NOT = { is_planet_class = pc_ring_world }
					}
					change_planet_size = 5
					add_zone = {
						district = district_city
						zone = xhk_zone_capital_knights
						zone_slot = 1
						replace = yes
					} 
				} 
				else = {
					add_zone = {
						district = district_rw_city
						zone = xhk_zone_capital_knights
						zone_slot = 1
						replace = yes
					} 
				}
				
				add_deposit = d_toxic_god_blight_upon_the_land
				add_deposit = d_toxic_god_deitys_swarms
				add_deposit = d_toxic_god_pools_most_venemous
				add_deposit = d_toxic_god_pestilential_wasteland
				add_deposit = d_toxic_god_envenomed_seas
				add_deposit = d_knights_calibrator
				
				add_building = {
					zone = xhk_zone_capital_knights
					building = building_order_keep
				}
				
			}
		}
		# mimics toxoids.7000
		start_situation = {
			type = situation_toxic_knights
		}
		custom_tooltip = "edict_decision_origins_toxic_knights_tt"
		show_only_custom_tooltip = no
	}
}

decision_origins_mechanist = {
	length = 1
	icon = "GFX_edict_type_policy"
	
	resources = {
		category = edicts
	}

	potential = {
		host_has_dlc = "Utopia"
		is_ai = no
		days_passed < 30
		NOT = {
			has_country_flag = decision_origins_mechanist
		}
	}

	effect = {
		hidden_effect = {
			set_country_flag = decision_origins_mechanist

			if = {
				limit = {
					NOR = {	#if biological
						is_machine_empire = yes
						is_individual_machine = yes
					}
				}
				capital_scope = {
					add_building = {
						zone = slot_city_government
						building = building_robot_assembly_plant
					}
				}
				give_technology = {
					tech = tech_powered_exoskeletons
				}
				give_technology = {
					tech = tech_robotic_workers
				}
				add_modifier = {
					modifier = xhk_decori_mechanists_modifier
				}
			}
			else = {
				add_modifier = {
					modifier = xhk_decori_mechanists_machine_modifier
				}
			}
		}
		
		add_tech_progress = {
			tech = tech_robomodding
			progress = 0
		}
		
		custom_tooltip = "edict_decision_origins_mechanist_tt"
		show_only_custom_tooltip = no
	}
}

decision_origins_galactic_doorstep = {
	length = 1
	icon = "GFX_edict_type_policy"
	
	resources = {
		category = edicts
	}

	potential = {
		is_ai = no
		# no dlc needed for this one
		days_passed < 30
		NOT = {
			has_country_flag = decision_origins_galactic_doorstep
		}
	}

	effect = {
		hidden_effect = {
			set_country_flag = decision_origins_galactic_doorstep
			set_country_flag = encountered_first_gateway
			country_event = { id = origin.1000 days = 300 random = 30 }
			add_modifier = {
				modifier = xhk_decori_doorstep_modifier
			}
			# this mimics origin.1001
			capital_scope = {
				solar_system = {
					spawn_megastructure = {
						name = "NAME_Galactic_Doorstep"
						type = "gateway_ruined"
						random_pos = yes
						orbit_angle = 360
						init_effect = {
							set_megastructure_flag = doorstep_gateway@root
							save_event_target_as = doorstep_gateway
						}
					}
					set_star_flag = abandoned_gateway
				}
			}
		}
		custom_tooltip = "edict_decision_origins_galactic_doorstep_tt"
		show_only_custom_tooltip = no
	}
}

decision_origins_syncretic_evolution = {
	length = 1
	icon = "GFX_edict_type_policy"
	
	resources = {
		category = edicts
	}

	potential = {
		host_has_dlc = "Utopia"
		is_ai = no
		days_passed < 30
		NOT = {
			has_country_flag = decision_origins_syncretic_evolution
		}
	}

	allow = {
		days_passed > 0
	}

	effect = {
		hidden_effect = {
			set_country_flag = decision_origins_syncretic_evolution
		}
		
		capital_scope = {

			if = {
				limit = { owner = { has_civic = civic_machine_assimilator } }
				# make them cybernetic
				create_species = {
					name = random
					class = random
					namelist = random
					portrait = random
					homeworld = planet
					traits = {
						trait = trait_syncretic_proles
						trait = trait_cybernetic
					}
				}
			}
			else_if = {
				limit = { owner = { is_hive_empire = yes } }
				# make them hive
				create_species = {
					name = random
					class = random
					namelist = random
					portrait = random
					homeworld = planet
					traits = {
						trait = trait_syncretic_proles
						trait = trait_hive_mind
					}
				}
			}
			else = {
				# make them normal
				create_species = {
					name = random
					class = random
					namelist = random
					portrait = random
					homeworld = planet
					traits = {
						trait = trait_syncretic_proles
					}
				}
			}


			create_pop_group = {
				size = 1200
				species = last_created_species
			}
			
			# if hive
			if = {
				limit = { owner = { is_hive_empire = yes } }
				last_created_species = {
					set_citizenship_type = {
						country = root.owner
						type = citizenship_full
					}
					# modify_species = {
					# 	species = this
					# 	ideal_planet_class = home_planet
					# }
				}
			}
			# if assimilator
			else_if = {
				limit = { owner = { has_civic = civic_machine_assimilator } }

				last_created_species = {
					set_citizenship_type = {
						country = root.owner
						type = citizenship_full_machine
					}
					# modify_species = {
					# 	species = this
					# 	ideal_planet_class = home_planet
					# }
				}

			}
			# otherwise
			else = {
				last_created_species = {
					# try to force slavery
					set_citizenship_type = {
						country = root.owner
						type = citizenship_slavery
					}
					# modify_species = {
					# 	species = this
					# 	ideal_planet_class = home_planet
					# }
				}
			}
		}

		custom_tooltip = "edict_decision_origins_syncretic_evolution_tt"
		show_only_custom_tooltip = no
	}
}

# spawns a shattered ring system next to capital
decision_origins_spawn_shattered_ring = {
	length = 1
	icon = "GFX_edict_type_policy"
	
	resources = {
		category = edicts
	}

	potential = {
		is_ai = no
		host_has_dlc = "Federations"
		days_passed < 30
		NOT = {
			has_country_flag = decision_origins_shattered_ring
		}
	}

	effect = {
		hidden_effect = {
			set_country_flag = decision_origins_shattered_ring
			capital_scope = {
				spawn_system = {
					min_distance = 10
					max_distance = 30
					max_jumps = 0
					initializer = shattered_ring_start
				}
				if = {
					limit = { last_created_system = { NOT = { has_hyperlane_to = prev } } }
					add_hyperlane = {
						from = this
						to = last_created_system
					}
				}
				else = {
					add_extra_hyperlane_to_spawned_system_effect = yes
				}
			}
		}
	}
}
