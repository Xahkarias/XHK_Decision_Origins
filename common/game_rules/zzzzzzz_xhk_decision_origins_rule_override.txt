can_remove_positive_traits_organic = {
	OR = {
		AND = {
			OR = {
				has_utopia = yes
				has_biogenesis_dlc = yes
			}
			OR = {
				has_tradition = tr_genetics_resequencing
				has_active_tradition = tr_cybernetics_integrated_anatomy
				has_active_tradition = tr_cybernetics_assimilator_integrated_anatomy
				has_active_tradition = tr_purity_genotype_regeneration
				has_active_tradition = tr_purity_genotype_regeneration_wilderness
				has_active_tradition = tr_cloning_somatic_synthesization
				has_active_tradition = tr_cloning_somatic_synthesization_clone_army
				has_active_tradition = tr_mutation_unnatural_selection
			}
		}
		AND = {
			has_toxoids = yes
			has_overtuned_origin = yes
		}
		has_technology = tech_gene_expressions
		has_technology = tech_epigenetic_triggers
	}
}

species_can_live_on_planet = {
    hidden_trigger = {
        exists = root #somehow this appeared in the error log. No idea how!
        NAND = {
            root = { is_planet_class = pc_machine }
            NOR = {
                has_trait = trait_machine_unit
                has_trait = trait_mechanical
                AND = {
                    has_trait = trait_cybernetic
                    exists = root.owner
                    root.owner = {
                        is_machine_empire = yes
                        OR = {
                            has_civic = civic_machine_assimilator # Assimilator empire
                            has_ascension_perk = ap_mechromancy
                        }
                    }
                }
            }
        }
        if = {
            limit = {
                root = { is_planet_class = pc_hive }
            }
            OR = {
                has_trait = trait_hive_mind
                AND = { #Necrophage Hive Mind can have Necrophytes
                    exists = root.owner
                    root.owner = {
                        is_hive_empire = yes
                        has_origin = origin_necrophage
                        prev = { species_can_be_necrophaged = yes }
                    }
                }
            }
        }
    }
    if = {
        limit = {
            exists = root.owner
            root.owner = {
                has_clone_army_origin = yes
            }
            OR = {
                has_trait = trait_clone_soldier_infertile
                has_trait = trait_clone_soldier_infertile_full_potential
            }
        }
        custom_tooltip = {
            fail_text = CLONE_ARMY_FORCE_DECLINE
            root = {
                check_variable = { which = clone_pops_missing value >= 0 }
            }
        }
    }
    custom_tooltip = {
        fail_text = WILDERNESS_NATURAL_WORLDS_DECLINE
        if = {
            limit = {
                has_trait = trait_wilderness
            }
            root = { is_habitable_for_wilderness = yes }
        }
    }

    custom_tooltip = {
        fail_text = WILDERNESS_DEAD_WORLD
        if = {
            limit = {
                has_trait = trait_wilderness
                exists = root.owner
            }
            root.owner = { is_wilderness_empire = yes }
        }
    }
}

should_force_decline_species = {
    OR = {
        # Infertile Clone Army pops should decline if in Country that can't have Vats, or there is a Vat shortage.
        custom_tooltip = {
            success_text = CLONE_ARMY_FORCE_DECLINE
            exists = this
            OR = {
                has_trait = trait_clone_soldier_infertile
                has_trait = trait_clone_soldier_infertile_full_potential
            }
            from = {
                OR = {
                    # Check if country is unable to build Vats for this species.
                    AND = {
                        exists = owner
                        owner = {
                            OR = {
                                NOT = { has_clone_army_origin = yes }					# Can't have Vats.
                                has_country_flag = clone_army_fertility_unlocked			# Can't have Vats anymore.
                                NOT = { owner_main_species = { is_same_species = root } }	# Our Vats can't build this species.
                            }
                        }
                    }
                    # Vats check out, but are there more pops than Vats support?
                    check_variable = { which = clone_pops_missing value < 0 }
                }
            }
        }

        from = {
            custom_tooltip = {
                success_text = VOIDSPAWN_FORCE_DECLINE
                exists = this
                has_modifier = voidspawn_colony_mod
            }
        }
    }
}
