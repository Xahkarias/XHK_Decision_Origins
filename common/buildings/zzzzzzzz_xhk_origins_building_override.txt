building_identity_repository = {
	base_buildtime = @b2_time
	planet_limit = 1
	position_priority = 100
	can_demolish = no
	can_be_disabled = no

	category = research

	building_sets = {
		government
		research
		physics
		society
		engineering
	}

	potential = {
		exists = owner
		owner = {
			has_synthetic_fertility_origin = yes
			NOT = { has_country_flag = synthetic_fertility_no_identity_left_behind }
		}
	}

	destroy_trigger = {
		exists = owner
		owner = {
			has_synthetic_fertility_origin = no
		}
	}

	convert_to = {
		building_research_lab_1
	}

	allow = {
		owner = { 
			has_synthetic_fertility_origin = yes
		}
	}

	resources = {
		category = planet_buildings
		cost = {
			minerals = @b4_minerals
		}
		upkeep = {
			energy = 0.02
			mult = owner.value:identity_repository_scaling_mult
		}
		produces = {
			trigger = {
				exists = owner
				owner = { 
					has_synthetic_fertility_origin = yes
				}
			}
			physics_research = 0.02
			society_research = 0.02
			engineering_research = 0.02
			unity = 0.02
			trade = 0.02
			mult = owner.value:identity_repository_scaling_mult
		}
	}

	triggered_planet_modifier = {
		robotic_pop_bonus_workforce_mult = 0.0001
		mult = owner.value:identity_repository_scaling_mult
	}

	triggered_desc = {
		text = building_identity_repository_tt
	}
}

building_abandoned_gene_clinic = {
	icon = building_ancient_cryo_chamber
	position_priority = 100
	can_demolish = no
	can_build = no

	category = amenity

	building_sets = {
		government
	}

	potential = {
		exists = owner
		owner = { 
			has_synthetic_fertility_origin = yes
		}
	}

	destroy_trigger = {
		exists = owner
		owner = { 
			has_synthetic_fertility_origin = no
		}
	}

	allow = {
		owner = { 
			has_synthetic_fertility_origin = yes
		}
	}

	triggered_desc = {
		text = building_abandoned_gene_clinic_tt
	}
}

building_citadel_uplink = {
    base_buildtime = @b3_time
    planetary_ftl_inhibitor = yes
    position_priority = 100
    can_be_ruined = no
    category = army
    planet_limit = 1

    category = planet_buildings

    building_sets = {
        government
        fortress
    }

    potential = {
        exists = owner
        owner = {
            has_starlit_citadel_origin = yes
        }
    }

    allow = {
        exists = solar_system
        solar_system = {
            custom_tooltip = {
                text = "requires_deep_space_citadel"
                count_ship_in_system = {
                    limit = {
                        is_space_citadel_ship_size = yes
                    }
                    count > 0
                }
            }
        }
    }

    destroy_trigger = {
        exists = owner
        exists = solar_system
        OR = {
            owner = {
                NOT = {
                    has_starlit_citadel_origin = yes
                }
            }
            solar_system = {
                count_ship_in_system = {
                    limit = {
                        is_space_citadel_ship_size = yes
                    }
                    count = 0
                }
            }
        }
    }

    convert_to = {
        building_fortress
    }

    resources = {
        category = planet_buildings
        cost = {
            minerals = @b3_minerals
        }
        upkeep = {
            energy = @b3_upkeep
        }
    }

    triggered_planet_modifier = {
        potential = {
            exists = solar_system
            OR = {
                is_scope_valid = no
                AND = {
                    exists = owner
                    owner = { is_regular_empire = yes }
                }
            }
        }
        job_skywatcher_add = @building_static_jobs
        mult = solar_system.value:skywatcher_dsc_mult
    }

    triggered_planet_modifier = {
        potential = {
            exists = solar_system
            exists = owner
            owner = { is_gestalt = yes }
        }
        job_skywatcher_drone_add = @building_static_jobs
        mult = solar_system.value:skywatcher_dsc_mult
    }

    triggered_desc = {
        trigger = {
            exists = owner
            exists = solar_system
            owner = {
                is_gestalt = no
            }
            NOT = {
                solar_system = {
                    any_ship_in_system = {
                        is_ship_size = starbase_deep_space_citadel_3
                    }
                }
            }
        }
        text = job_skywatcher_add_dsc_tt
    }

    triggered_desc = {
        trigger = {
            exists = owner
            exists = solar_system
            owner = {
                is_gestalt = yes
            }
            NOT = {
                solar_system = {
                    any_ship_in_system = {
                        is_ship_size = starbase_deep_space_citadel_3
                    }
                }
            }
        }
        text = job_skywatcher_drone_add_dsc_tt
    }
}